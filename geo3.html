<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Fit to the bounds of a LineString</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: rgb(59, 59, 59);
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
            height: 50%;
        }
    </style>
</head>

<body>
    <style>
        .btn-control {
            font:
                bold 12px/20px 'Helvetica Neue',
                Arial,
                Helvetica,
                sans-serif;
            background-color: #3386c0;
            color: #fff;
            position: absolute;
            top: 20px;
            left: 50%;
            z-index: 1;
            border: none;
            width: 200px;
            margin-left: -100px;
            display: block;
            cursor: pointer;
            padding: 10px 20px;
            border-radius: 3px;
        }

        .btn-control:hover {
            background-color: #4ea0da;
        }
    </style>
    <div>
    <div id="map"></div>
    <button id="zoomto" class="btn-control">Zoom to bounds</button>
</div>
    <div style="background-color: rgb(59, 59, 59); margin-top: 100%; height: 35vh; text-align: center;">
        <div>
            <h1 id="mtr" style="color: #c6c6c6;">mtr:  <span style="color: rgb(105, 200, 232);">959595</span>  </h3>
                <textarea id="teeext">

                </textarea>
        </div>
        <div>
            <button style="width: 100%; height: 15vh; border: solid 10px black ;border-radius: 20px;"> STOP </button>
        </div>
       
    </div>
    <div>
       
    </div>

    <script>//19.0253532,-98.2610225
        mapboxgl.accessToken = 'pk.eyJ1IjoibWFyY29qcnp4IiwiYSI6ImNrNnNiN3pxbzA0YmozbXBhYmcwbzRlODIifQ.OWa3PQOhcF9vYvdunV5YEQ';
        // A GeoJSON object with a LineString route from the White House to Capitol Hill
        //[-98.2563381, 19.0149206],[-98.2563349, 19.0149512],[-98.2566937, 19.0154301],[-98.2555881, 19.0156364],[-98.2553385, 19.0157569],[-98.2552997, 19.0157667],[-98.2545264, 19.0160213],[-98.2532136, 19.0157635],[-98.2526997, 19.0160955],[-98.2526636, 19.0161849],[-98.2516116, 19.0167825],[-98.2515921, 19.0168071],[-98.2507902, 19.0173133],[-98.2509112, 19.0173363],[-98.2506205, 19.0181853],[-98.2507569, 19.0184791],[-98.2502009, 19.018238],[-98.2500647, 19.0178243],[-98.2498111, 19.0174193],[-98.2517387, 19.0142224],[-98.2517387, 19.0142224],[-98.2517387, 19.0142224],[-98.2517387, 19.0142224],[-98.247623, 19.0204977],[-98.2476204, 19.0204723],[-98.2476195, 19.020463],[-98.2449411, 19.0198092],[-98.2449384, 19.0198114],[-98.2445879, 19.0221954],[-98.2445379, 19.0222884],[-98.244516, 19.0223556],[-98.2445851, 19.0223372],[-98.2441839, 19.022535],[-98.242005, 19.0213116],[-98.2442374, 19.0225039],[-98.242171, 19.0212718],[-98.2432807, 19.0222674],[-98.2434745, 19.0224412],[-98.2436819, 19.0226273],[-98.2438255, 19.0227561],[-98.243899, 19.0228221],[-98.24376, 19.0227013],[-98.2437677, 19.0227088],[-98.2480363, 19.015291],[-98.2480373, 19.0152928],[-98.2417905, 19.0226987],[-98.2415941, 19.0229926],[-98.2410647, 19.0232356],[-98.2410447, 19.023239],[-98.2403591, 19.0235067],[-98.2392002, 19.0238353],[-98.2390614, 19.0238397],[-98.2388529, 19.0241485],[-98.2386101, 19.024674],[-98.2386076, 19.0246867],[-98.2385182, 19.0246707],[-98.2385555, 19.0247322],[-98.2385661, 19.0246845],[-98.2380501, 19.0250815],[-98.2380506, 19.0250943],[-98.2380457, 19.0250559],[-98.2380397, 19.0250593],[-98.2380809, 19.0250587],[-98.2380927, 19.0250541],[-98.2380239, 19.0250663],[-98.2380091, 19.02508],[-98.2380063, 19.0250797],[-98.2380214, 19.0250815],[-98.2374854, 19.0252608],[-98.2364109, 19.0259313],[-98.2364236, 19.0259353],[-98.2348218, 19.0267728],[-98.2348055, 19.0267926],[-98.2333524, 19.0272973],[-98.2315286, 19.0306731],[-98.2315299, 19.0306756],[-98.2291947, 19.0287203],[-98.2289567, 19.0289979],[-98.2290587, 19.0306701],[-98.2284076, 19.0307115],[-98.2281804, 19.0320559],[-98.2282215, 19.0321723],[-98.2282456, 19.0320887],[-98.2281602, 19.0321069],[-98.228157, 19.0321076],[-98.2278643, 19.0316308],[-98.2269002, 19.0333309],[-98.2270506, 19.0335859],[-98.22707, 19.0335745]
        let coordenadas = []
        
        const geojson = {
            'type': 'FeatureCollection',
            'features': [
                {
                    'type': 'Feature',
                    'geometry': {
                        'type': 'LineString',
                        'coordinates': coordenadas
                    },
                    'properties': {},
                }
            ]
        };

        const map = new mapboxgl.Map({
            container: 'map',
            // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
            style: 'mapbox://styles/mapbox/light-v11',
            center: [-98.2610955, 19.0201406],
            zoom: 12
        });

        map.on('load', () => {
            map.addSource('LineString', {
                'type': 'geojson',
                'data': geojson
            });
            map.addLayer({
                'id': 'LineString',
                'type': 'line',
                'source': 'LineString',
                'layout': {
                    'line-join': 'round',
                    'line-cap': 'round'
                },
                'paint': {
                    'line-color': '#BF93E4',
                    'line-width': 5
                }
            });

            document.getElementById('zoomto').addEventListener('click', () => {
                // Geographic coordinates of the LineString
                const coordinates = geojson.features[0].geometry.coordinates;

                // Create a 'LngLatBounds' with both corners at the first coordinate.
                const bounds = new mapboxgl.LngLatBounds(
                    coordinates[0],
                    coordinates[0]
                );

                // Extend the 'LngLatBounds' to include every coordinate in the bounds result.
                for (const coord of coordinates) {
                    bounds.extend(coord);
                }

                map.fitBounds(bounds, {
                    padding: 20
                });
            });
            /*let i = 0;
            let aixx =[[-98.2673952, 19.0337002],[-98.2674406, 19.0338499],[-98.2674985, 19.0339992],[-98.2675661, 19.0341435],[-98.267637, 19.034288],[-98.2677289, 19.034431],[-98.2678209, 19.0345735],[-98.2679124, 19.0347146],[-98.268009, 19.0348431],[-98.2681057, 19.0349755],[-98.2682038, 19.0351131],[-98.2683023, 19.0352515],[-98.2684032, 19.0353945],[-98.268508, 19.0355306],[-98.268625, 19.0356687],[-98.2687334, 19.0358101],[-98.2688373, 19.0359648],[-98.2689444, 19.0361293],[-98.2690404, 19.0362974],[-98.2691127, 19.0364781],[-98.2691686, 19.0366662],[-98.269228, 19.0368481],[-98.2692842, 19.0370363],[-98.2693398, 19.0372221],[-98.2693934, 19.0374028],[-98.2694417, 19.0375816],[-98.2694887, 19.0377586],[-98.2695388, 19.0379317],[-98.2695906, 19.0380975],[-98.2696478, 19.038258],[-98.2697049, 19.0384232],[-98.2697573, 19.0385921],[-98.2698146, 19.0387547],[-98.2698748, 19.0389137],[-98.2699431, 19.0390673],[-98.2700209, 19.0392164],[-98.2701116, 19.0393612],[-98.2702076, 19.0394953],[-98.2703171, 19.0396307],[-98.2704307, 19.0397652],[-98.2705505, 19.0398968],[-98.2706738, 19.0400151],[-98.2708045, 19.0401282],[-98.2709446, 19.0402303],[-98.2710865, 19.0403194],[-98.2712359, 19.0404193],[-98.2713917, 19.0405043],[-98.2715502, 19.0405857],[-98.2717132, 19.0406666],[-98.271881, 19.0407446],[-98.272051, 19.0408216],[-98.2722218, 19.0408939],[-98.2723879, 19.0409695],[-98.2725608, 19.0410415],[-98.2727394, 19.0411121],[-98.2729145, 19.0411864],[-98.2730841, 19.041258],[-98.2732515, 19.0413265],[-98.2734224, 19.0413933],[-98.2735982, 19.0414675],[-98.2737747, 19.0415397],[-98.2739471, 19.0416114],[-98.274118, 19.0416846],[-98.2742894, 19.0417536],[-98.2744582, 19.0418235],[-98.2746224, 19.0419019],[-98.2747856, 19.0419815],[-98.2749534, 19.0420499],[-98.2751187, 19.0421168],[-98.2752868, 19.0421793],[-98.2754553, 19.0422524],[-98.2756238, 19.0423385],[-98.2757871, 19.0424225],[-98.2759517, 19.0425121],[-98.2761111, 19.0426074],[-98.2762617, 19.042715],[-98.2764198, 19.0428297],[-98.2765582, 19.042955],[-98.2766905, 19.0430875],[-98.2768193, 19.0432219],[-98.2769382, 19.0433621],[-98.2770512, 19.0435052],[-98.2771521, 19.0436522],[-98.2772433, 19.0438024],[-98.2773237, 19.0439574],[-98.2773964, 19.0441147],[-98.2774606, 19.0442811],[-98.2775228, 19.0444555],[-98.2775718, 19.0446239],[-98.2776074, 19.0447881],[-98.2776345, 19.0449601],[-98.2776583, 19.045139],[-98.2776806, 19.0453215],[-98.2777052, 19.0455019],[-98.2777282, 19.0456738],[-98.2777459, 19.0458497],[-98.2777613, 19.0460288],[-98.2777862, 19.0462031],[-98.2778118, 19.0463827],[-98.2778336, 19.0465648],[-98.2778582, 19.0467527],[-98.2778823, 19.0469339],[-98.2779001, 19.0471171],[-98.2779212, 19.0473046],[-98.2779394, 19.04749],[-98.2779634, 19.0476782],[-98.2779854, 19.0478689],[-98.2780127, 19.0480535],[-98.2780357, 19.0482364],[-98.2780603, 19.0484133],[-98.2780809, 19.0485852],[-98.2781051, 19.0487504],[-98.2781314, 19.0489107],[-98.278155, 19.0490675],[-98.2781723, 19.0492279],[-98.2781868, 19.0493881],[-98.2782049, 19.0495596],[-98.2782209, 19.0497272],[-98.2782463, 19.0498825],[-98.2782664, 19.050051],[-98.2782807, 19.0502222],[-98.2782984, 19.050385],[-98.2783156, 19.0505432],[-98.2783308, 19.0506923],[-98.2783458, 19.0508371],[-98.2783607, 19.0509774],[-98.2783799, 19.051116],[-98.2783956, 19.0512586],[-98.2784103, 19.0514079],[-98.2784239, 19.0515588],[-98.2784397, 19.0517106],[-98.2784539, 19.0518725],[-98.2784764, 19.0520318],[-98.2784939, 19.0521876],[-98.2785091, 19.0523282],[-98.278528, 19.0524529],[-98.2785407, 19.0525771],[-98.2785577, 19.0527045],[-98.2785837, 19.0528331],[-98.2785964, 19.0529741],[-98.2786118, 19.0531198],[-98.2786269, 19.0532677],[-98.2786422, 19.0534083],[-98.2786558, 19.0535409],[-98.2786659, 19.0536677],[-98.2786673, 19.0537905],[-98.2786688, 19.053899],[-98.27868, 19.0540047],[-98.2786815, 19.0541139],[-98.2786876, 19.0542163],[-98.2787027, 19.0543262],[-98.27872, 19.0544385],[-98.2787309, 19.0545533],[-98.278743, 19.0546649],[-98.278754, 19.0547853],[-98.2787598, 19.0549106],[-98.2787625, 19.0550384],[-98.2787691, 19.0551789],[-98.2787705, 19.0553198],[-98.2787604, 19.0554601],[-98.2787467, 19.0555994],[-98.2787269, 19.0557342],[-98.2787039, 19.0558611],[-98.2786856, 19.0559892],[-98.2786552, 19.0561115],[-98.2786166, 19.0562275],[-98.2785736, 19.0563393],[-98.2785318, 19.0564562],[-98.2784844, 19.0565634],[-98.2784263, 19.0566657],[-98.2783576, 19.0567734],[-98.2782859, 19.0568845],[-98.2782077, 19.0570055],[-98.2781256, 19.0571261],[-98.2780389, 19.0572496],[-98.2779531, 19.0573694],[-98.2778669, 19.0574874],[-98.2777817, 19.0575947],[-98.2776902, 19.0577094],[-98.2776031, 19.0578258],[-98.2775139, 19.057938],[-98.2774355, 19.0580464],[-98.2773574, 19.0581541],[-98.2773469, 19.0581691],[-98.2772979, 19.0582522],[-98.2772456, 19.0583574],[-98.2771869, 19.0584586],[-98.2771346, 19.0585674],[-98.277084, 19.0586734],[-98.2770361, 19.0587734],[-98.2769949, 19.0588702],[-98.2769605, 19.0589574],[-98.2769328, 19.0590367],[-98.2769129, 19.0591151],[-98.2768902, 19.0591883],[-98.276865, 19.0592563],[-98.2768468, 19.0593213],[-98.2768293, 19.0593812],[-98.2768166, 19.0594289],[-98.2768067, 19.0594684],[-98.2767825, 19.0595059],[-98.2767382, 19.0595329],[-98.2766766, 19.0595386],[-98.2765935, 19.0595292],[-98.2765021, 19.0595193],[-98.2764054, 19.0595116],[-98.2763124, 19.0595102],[-98.2762215, 19.0595113],[-98.2761372, 19.0595123],[-98.2760494, 19.0595288],[-98.2759581, 19.0595528],[-98.2758573, 19.0595841],[-98.2757477, 19.0596022],[-98.2756255, 19.059607],[-98.275494, 19.0596096],[-98.2753546, 19.059612],[-98.2752035, 19.0596185],[-98.275051, 19.0596228],[-98.2748936, 19.059624],[-98.2747324, 19.0596238],[-98.2745628, 19.0596231],[-98.2743866, 19.0596188],[-98.2742132, 19.0596174],[-98.2740449, 19.0596157],[-98.273988, 19.0596155],[-98.2738856, 19.059614],[-98.2737188, 19.0596137],[-98.2735563, 19.0596151],[-98.2733963, 19.0596176],[-98.2732406, 19.0596221],[-98.2730888, 19.05963],[-98.2729464, 19.0596306],[-98.2728143, 19.0596316],[-98.2726823, 19.0596336],[-98.2725458, 19.0596409],[-98.2724162, 19.0596381],[-98.2722775, 19.0596381],[-98.2721276, 19.0596414],[-98.2719772, 19.0596467],[-98.2718176, 19.0596495],[-98.2716564, 19.05965],[-98.2714979, 19.0596443],[-98.2713346, 19.0596454],[-98.2711655, 19.0596432],[-98.2709997, 19.0596351],[-98.2708422, 19.0596319]];
            const timer = setInterval(() => {
             if (i < aixx.length) {
                const element = aixx[i];
                console.log("element >>> ",element);
                geojson.features[0].geometry.coordinates.push(element);
                map.getSource('LineString').setData(geojson);
                console.log("setInterval >> ");
                i++;
             } else {

            window.clearInterval(timer);
             }
            }, 30);*/
        });

    let saveData = true;
    let textarea = document.getElementById("teeext");
    let arregloAux = [];
    function stopSave() {
        saveData = false;
    }
    const watchID = navigator.geolocation.watchPosition((position) => {
        console.log(" >>>> position.coords.latitude >> ",position.coords.latitude);
        console.log(" >>>> position.coords.longitude >> ",position.coords.longitude);
         if(saveData && position.coords.accuracy < 6) {
            arregloAux.push(position.coords.longitude);longitude
            arregloAux.push(position.coords.latitude);
            geojson.features[0].geometry.coordinates.push(arregloAux);
            document.getElementById('teeext').value = JSON.stringify(arregloAux); 
            arregloAux = [];
            map.getSource('LineString').setData(geojson);
            document.getElementById('mtr').innerHTML = "Metros: "+position.coords.accuracy+" <<< "; 
            
         } else {
            arregloAux.push("STOP");
            document.getElementById('teeext').value = JSON.stringify(arregloAux); 
            saveData = false;
         }
        
            
        });
    </script>

</body>

</html>