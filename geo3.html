<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Fit to the bounds of a LineString</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: rgb(59, 59, 59);
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
            height: 50%;
        }
    </style>
</head>

<body>
    <style>
        .btn-control {
            font:
                bold 12px/20px 'Helvetica Neue',
                Arial,
                Helvetica,
                sans-serif;
            background-color: #3386c0;
            color: #fff;
            position: absolute;
            top: 20px;
            left: 50%;
            z-index: 1;
            border: none;
            width: 200px;
            margin-left: -100px;
            display: block;
            cursor: pointer;
            padding: 10px 20px;
            border-radius: 3px;
        }

        .btn-control:hover {
            background-color: #4ea0da;
        }
    </style>
    <div>
    <div id="map"></div>
    <button id="zoomto" class="btn-control">Zoom to bounds</button>
</div>
    <div style="background-color: rgb(59, 59, 59); position: relative;
    top: 53vh;  height: 35vh; text-align: center;">
        <div>
            <h1  style="color: #c6c6c6;">mtr:  <span id="mtr" style="color: rgb(105, 200, 232);">959595</span>  </h3>
                <textarea id="teeext">

                </textarea>
        </div>
        <div>
            <button style="width: 100%; height: 15vh; border: solid 10px black ;border-radius: 20px;" click="stopSave();"> STOP </button>
        </div>
       
    </div>
    <div>
       
    </div>

    <script>//19.0253532,-98.2610225
    let options = {
  enableHighAccuracy: true,
  timeout: 5000,
  maximumAge: 0,
};

        mapboxgl.accessToken = 'pk.eyJ1IjoibWFyY29qcnp4IiwiYSI6ImNrNnNiN3pxbzA0YmozbXBhYmcwbzRlODIifQ.OWa3PQOhcF9vYvdunV5YEQ';
        // A GeoJSON object with a LineString route from the White House to Capitol Hill
        //[-98.2563381, 19.0149206],[-98.2563349, 19.0149512],[-98.2566937, 19.0154301],[-98.2555881, 19.0156364],[-98.2553385, 19.0157569],[-98.2552997, 19.0157667],[-98.2545264, 19.0160213],[-98.2532136, 19.0157635],[-98.2526997, 19.0160955],[-98.2526636, 19.0161849],[-98.2516116, 19.0167825],[-98.2515921, 19.0168071],[-98.2507902, 19.0173133],[-98.2509112, 19.0173363],[-98.2506205, 19.0181853],[-98.2507569, 19.0184791],[-98.2502009, 19.018238],[-98.2500647, 19.0178243],[-98.2498111, 19.0174193],[-98.2517387, 19.0142224],[-98.2517387, 19.0142224],[-98.2517387, 19.0142224],[-98.2517387, 19.0142224],[-98.247623, 19.0204977],[-98.2476204, 19.0204723],[-98.2476195, 19.020463],[-98.2449411, 19.0198092],[-98.2449384, 19.0198114],[-98.2445879, 19.0221954],[-98.2445379, 19.0222884],[-98.244516, 19.0223556],[-98.2445851, 19.0223372],[-98.2441839, 19.022535],[-98.242005, 19.0213116],[-98.2442374, 19.0225039],[-98.242171, 19.0212718],[-98.2432807, 19.0222674],[-98.2434745, 19.0224412],[-98.2436819, 19.0226273],[-98.2438255, 19.0227561],[-98.243899, 19.0228221],[-98.24376, 19.0227013],[-98.2437677, 19.0227088],[-98.2480363, 19.015291],[-98.2480373, 19.0152928],[-98.2417905, 19.0226987],[-98.2415941, 19.0229926],[-98.2410647, 19.0232356],[-98.2410447, 19.023239],[-98.2403591, 19.0235067],[-98.2392002, 19.0238353],[-98.2390614, 19.0238397],[-98.2388529, 19.0241485],[-98.2386101, 19.024674],[-98.2386076, 19.0246867],[-98.2385182, 19.0246707],[-98.2385555, 19.0247322],[-98.2385661, 19.0246845],[-98.2380501, 19.0250815],[-98.2380506, 19.0250943],[-98.2380457, 19.0250559],[-98.2380397, 19.0250593],[-98.2380809, 19.0250587],[-98.2380927, 19.0250541],[-98.2380239, 19.0250663],[-98.2380091, 19.02508],[-98.2380063, 19.0250797],[-98.2380214, 19.0250815],[-98.2374854, 19.0252608],[-98.2364109, 19.0259313],[-98.2364236, 19.0259353],[-98.2348218, 19.0267728],[-98.2348055, 19.0267926],[-98.2333524, 19.0272973],[-98.2315286, 19.0306731],[-98.2315299, 19.0306756],[-98.2291947, 19.0287203],[-98.2289567, 19.0289979],[-98.2290587, 19.0306701],[-98.2284076, 19.0307115],[-98.2281804, 19.0320559],[-98.2282215, 19.0321723],[-98.2282456, 19.0320887],[-98.2281602, 19.0321069],[-98.228157, 19.0321076],[-98.2278643, 19.0316308],[-98.2269002, 19.0333309],[-98.2270506, 19.0335859],[-98.22707, 19.0335745]
        let coordenadas = []
        
        const geojson = {
            'type': 'FeatureCollection',
            'features': [
                {
                    'type': 'Feature',
                    'geometry': {
                        'type': 'LineString',
                        'coordinates': coordenadas
                    },
                    'properties': {},
                }
            ]
        };

        const map = new mapboxgl.Map({
            container: 'map',
            // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
            style: 'mapbox://styles/mapbox/light-v11',
            center: [-98.2610955, 19.0201406],
            zoom: 12
        });

        map.on('load', () => {
            map.addSource('LineString', {
                'type': 'geojson',
                'data': geojson
            });
            map.addLayer({
                'id': 'LineString',
                'type': 'line',
                'source': 'LineString',
                'layout': {
                    'line-join': 'round',
                    'line-cap': 'round'
                },
                'paint': {
                    'line-color': '#BF93E4',
                    'line-width': 5
                }
            });

            document.getElementById('zoomto').addEventListener('click', () => {
                // Geographic coordinates of the LineString
                const coordinates = geojson.features[0].geometry.coordinates;

                // Create a 'LngLatBounds' with both corners at the first coordinate.
                const bounds = new mapboxgl.LngLatBounds(
                    coordinates[0],
                    coordinates[0]
                );

                // Extend the 'LngLatBounds' to include every coordinate in the bounds result.
                for (const coord of coordinates) {
                    bounds.extend(coord);
                }

                map.fitBounds(bounds, {
                    padding: 20
                });
            });

        });

    let saveData = true;
    let textarea = document.getElementById("teeext");
    let arregloAux = [];
    function stopSave() {
        saveData = false;
    }
    let cooordenadas = [[-98.2616583, 19.023395],[-98.2616583, 19.023395],[-98.2616583, 19.023395],[-98.2616583, 19.023395],[-98.2616771, 19.0233604],[-98.2616935, 19.0233157],[-98.2617062, 19.023265],[-98.2617173, 19.0232082],[-98.2617315, 19.023145],[-98.2617489, 19.0230818],[-98.2617609, 19.0230268],[-98.2617688, 19.0229846],[-98.2617744, 19.0229488],[-98.2617792, 19.0229142],[-98.2617875, 19.0228771],[-98.2618036, 19.0228346],[-98.2618173, 19.0227821],[-98.2618303, 19.0227148],[-98.261845, 19.022641],[-98.2618661, 19.0225645],[-98.2618909, 19.0224788],[-98.2619154, 19.0223845],[-98.2619355, 19.0222882],[-98.2619579, 19.0221921],[-98.261986, 19.0220902],[-98.2620098, 19.0219891],[-98.2620369, 19.021889],[-98.2620638, 19.0217842],[-98.262088, 19.0216748],[-98.2621141, 19.0215708],[-98.2621398, 19.021469],[-98.2621663, 19.0213669],[-98.2621852, 19.0212671],[-98.2622057, 19.0211727],[-98.2622291, 19.0210787],[-98.262252, 19.0209894],[-98.2622722, 19.0209001],[-98.2622922, 19.0208121],[-98.2623149, 19.0207306],[-98.2623367, 19.020652],[-98.2623569, 19.0205791],[-98.2623745, 19.0205054],[-98.2623879, 19.020431],[-98.2624075, 19.0203546],[-98.262424, 19.020278],[-98.2624444, 19.0202064],[-98.2624697, 19.0201338],[-98.2624935, 19.0200665],[-98.2625104, 19.0200137],[-98.2625205, 19.0199714],[-98.2625263, 19.0199433],[-98.2625306, 19.0199251],[-98.26253, 19.0199102],[-98.2625305, 19.019898],[-98.2625316, 19.0198836],[-98.262534, 19.0198641],[-98.2625395, 19.0198401],[-98.2625474, 19.0198043],[-98.262557, 19.0197651],[-98.2625708, 19.0197176],[-98.2625872, 19.0196667],[-98.2626017, 19.0196121],[-98.2626158, 19.0195684],[-98.262627, 19.0195389],[-98.2626333, 19.0195231],[-98.2626382, 19.0195134],[-98.2626441, 19.0195037],[-98.2626493, 19.0194931],[-98.2626518, 19.0194804],[-98.2626548, 19.0194627],[-98.2626556, 19.0194375],[-98.2626634, 19.0194054],[-98.262685, 19.0193691],[-98.2627146, 19.0193317],[-98.26275, 19.0192854],[-98.2627876, 19.0192393],[-98.2628251, 19.019195],[-98.2628597, 19.0191531],[-98.2628883, 19.0191209],[-98.26292, 19.0190924],[-98.2629517, 19.0190669],[-98.2629877, 19.0190356],[-98.2630356, 19.0189983],[-98.2630903, 19.0189531],[-98.2631491, 19.0189059],[-98.2632156, 19.0188563],[-98.2632926, 19.0188128],[-98.2633712, 19.0187811],[-98.2634506, 19.0187568],[-98.2635255, 19.0187353],[-98.2635815, 19.0187208],[-98.2636287, 19.0187136],[-98.2636685, 19.018702],[-98.2637083, 19.0187031],[-98.2637598, 19.0187015],[-98.2638265, 19.0186972],[-98.2639053, 19.0186926],[-98.2639865, 19.0186936],[-98.2640692, 19.0187034],[-98.2641608, 19.0187191],[-98.2642564, 19.0187506],[-98.2643606, 19.0187909],[-98.264461, 19.0188371],[-98.2645559, 19.0188865],[-98.2646431, 19.0189338],[-98.2647133, 19.0189785],[-98.2647707, 19.0190218],[-98.264823, 19.0190599],[-98.2648653, 19.0190993],[-98.2648972, 19.0191447],[-98.264931, 19.0191987],[-98.2649735, 19.0192653],[-98.2650239, 19.0193442],[-98.2650761, 19.0194252],[-98.2651331, 19.0195111],[-98.2651889, 19.0196045],[-98.2652478, 19.0197005],[-98.2653076, 19.0197973],[-98.2653652, 19.019897],[-98.2654245, 19.0200017],[-98.2654788, 19.0201103],[-98.2655367, 19.0202252],[-98.2656111, 19.0203378],[-98.2656802, 19.0204538],[-98.2657448, 19.0205742],[-98.2658046, 19.0206981],[-98.2658636, 19.0208176],[-98.2659259, 19.0209395],[-98.2659875, 19.0210584],[-98.2660546, 19.0211719],[-98.2661138, 19.0212888],[-98.2661763, 19.0214046],[-98.2662423, 19.0215215],[-98.2663133, 19.0216373],[-98.2663859, 19.0217549],[-98.2664549, 19.0218707],[-98.2665244, 19.0219896],[-98.2665974, 19.0221099],[-98.2666645, 19.0222403],[-98.2667337, 19.0223724],[-98.2668009, 19.0225023],[-98.2668739, 19.0226362],[-98.2669393, 19.022771],[-98.2670075, 19.0228943],[-98.267077, 19.0230216],[-98.2671481, 19.0231487],[-98.2672185, 19.0232766],[-98.2672857, 19.0234061],[-98.2673552, 19.0235381],[-98.2674295, 19.0236729],[-98.2675046, 19.0238082],[-98.2675816, 19.0239421],[-98.2676529, 19.0240857],[-98.2677257, 19.0242296],[-98.2678047, 19.0243747],[-98.267885, 19.0245168],[-98.2679675, 19.0246617],[-98.2680525, 19.024805],[-98.2681299, 19.0249487],[-98.2682053, 19.0250879],[-98.2682792, 19.0252261],[-98.2683541, 19.0253645],[-98.2684274, 19.0254974],[-98.2685029, 19.0256389],[-98.2685766, 19.0257749],[-98.2686468, 19.0259187],[-98.2687118, 19.0260639],[-98.2687646, 19.0262213],[-98.2688115, 19.0263773],[-98.2688532, 19.0265302],[-98.2688945, 19.0266911],[-98.2689341, 19.0268595],[-98.2689675, 19.0270366],[-98.2689919, 19.0272106],[-98.2690093, 19.0273813],[-98.2690308, 19.0275547],[-98.2690505, 19.0277323],[-98.269069, 19.0279148],[-98.269093, 19.0280795],[-98.2691009, 19.0282404],[-98.2690833, 19.0284116],[-98.2690565, 19.0285848],[-98.2690278, 19.0287584],[-98.268981, 19.0289262],[-98.26893, 19.0290939],[-98.2688668, 19.0292531],[-98.2687978, 19.0294054],[-98.2687162, 19.029558],[-98.2686242, 19.0297031],[-98.268531, 19.0298377],[-98.268439, 19.0299672],[-98.2683531, 19.0300765],[-98.2682722, 19.0301817],[-98.2681894, 19.0302865],[-98.2681084, 19.0303834],[-98.2680274, 19.0304726],[-98.2679535, 19.0305597],[-98.2678914, 19.0306521],[-98.2678276, 19.0307543],[-98.2677655, 19.0308577],[-98.2677045, 19.0309582],[-98.2676478, 19.0310655],[-98.2675989, 19.0311674],[-98.2675486, 19.0312737],[-98.2675014, 19.0313776],[-98.2674558, 19.0314985],[-98.267417, 19.0316218],[-98.2673838, 19.0317398],[-98.2673626, 19.0318586],[-98.267346, 19.0319815],[-98.2673258, 19.0321122],[-98.2673121, 19.0322453],[-98.2673014, 19.0323793],[-98.2672972, 19.0325174],[-98.2672857, 19.0326622],[-98.2672801, 19.0328075],[-98.2672693, 19.0329616],[-98.2672755, 19.0331096],[-98.2672852, 19.0332508],[-98.2673152, 19.0334],[-98.2673508, 19.0335513]]
    geojson.features[0].geometry.coordinates.push(cooordenadas);
    map.getSource('LineString').setData(geojson);
                     
    const watchID = navigator.geolocation.watchPosition((position) => {
        document.getElementById('mtr').innerHTML = "Metros: "+position.coords.accuracy+" <<< "; 
        console.log(" >>>> position.coords.latitude >> ",position.coords.latitude);
        console.log(" >>>> position.coords.longitude >> ",position.coords.longitude);
         if(saveData && position.coords.accuracy < 6) {
            //arregloAux.push(position.coords.longitude);
            //arregloAux.push(position.coords.latitude);
            //geojson.features[0].geometry.coordinates.push(arregloAux);
            document.getElementById('teeext').value = JSON.stringify(arregloAux); 
            //map.getSource('LineString').setData(geojson);
            document.getElementById('mtr').innerHTML = "Metros: "+position.coords.accuracy+" <<< "; 
            
         } else {
            arregloAux.push("STOP");
            document.getElementById('teeext').value = JSON.stringify(arregloAux); 
         }
        
            
        },() => {console.log("error") },options);
    </script>

</body>

</html>